!function(t,e,n,i){"use strict";var r=function(){var t=Array.prototype,e=t.slice,n=Object.prototype,r=Object.keys,o=n.hasOwnProperty,s=n.toString,a=Function.prototype.bind,u=function(t){return h.isString(t)?function(e){return e[t]}:t},l=function(t){return function(e,n,i){for(var r={},o=u(n),s=0,a=e.length;a>s;++s){var l=o.call(i,e[s],s,e);t(r,e[s],l)}return r}},h={};return h.isNull=function(t){return null===t},h.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===s.call(t)},h.bind=function(t,e){return a?t.bind(e):function(){return t.apply(e,arguments)}},h.constant=function(t){return function(){return t}},h.toArray=function(t){return h.map(t,function(t){return t})},h.isNaN=function(t){return h.isNumber(t)&&t!==+t},h.once=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments),t=null),e}},h.defaults=function(t,e){return h.forEach(h.keys(e),function(n){h.isUndefined(t[n])&&(t[n]=e[n])}),t},h.result=function(t,e){var n=t[e];return h.isFunction(n)?n.call(t):n},h.has=function(t,e){return o.call(t,e)},h.size=function(t){return null==t?0:t.length},h.first=function(t,n){return null==n?t[0]:e.call(t,0,n)},h.last=function(t,n){return null==n?t[t.length-1]:e.call(t,t.length-n,t.length)},h.rest=function(t,n){var i=arguments.length>1?n:1;return e.call(t,i,t.length)},h.initial=function(t,n){var i=t.length,r=arguments.length>1?i-n:i-1;return e.call(t,0,r)},h.indexOf=function(t,e){for(var n=0,i=t.length;i>n;++n)if(t[n]===e)return n;return-1},h.lastIndexOf=function(t,e){for(var n=t.length-1;n>=0;--n)if(t[n]===e)return n;return-1},h.contains=function(t,e){return h.indexOf(t,e)>=0},h.keys=function(t){if(!h.isObject(t))return[];if(r)return r(t);var e=[];for(var n in t)h.has(t,n)&&e.push(n);return e},h.functions=function(t){var e=[];for(var n in t)h.isFunction(t[n])&&e.push(n);return e.sort()},h.map=function(t,e,n){for(var i=[],r=0,o=t.length;o>r;++r)i[r]=e.call(n,t[r],r,t);return i},h.every=function(t,e,n){for(var i=0,r=t.length;r>i;++i)if(!e.call(n,t[i],i,t))return!1;return!0},h.some=function(t,e,n){for(var i=0,r=t.length;r>i;++i)if(e.call(n,t[i],i,t))return!0;return!1},h.filter=function(t,e,n){for(var i=[],r=0,o=t.length;o>r;++r)e.call(n,t[r],r,t)&&i.push(t[r]);return i},h.reject=function(t,e,n){for(var i=[],r=0,o=t.length;o>r;++r)e.call(n,t[r],r,t)||i.push(t[r]);return i},h.reduce=function(t,e,n,i){for(var r=arguments.length,o=r>=3?n:t[0],s=t.length,a=r>=3?0:1;s>a;++a)o=e.call(i,o,t[a],a,t);return o},h.reduceRight=function(t,e,n,i){for(var r=arguments.length,o=t.length-1,s=r>=3?n:t[o],a=r>=3?o:o-1;a>=0;--a)s=e.call(i,s,t[a],a,t);return s},h.find=function(t,e,n){for(var r=0,o=t.length;o>r;++r)if(e.call(n,t[r],r,t))return t[r];return i},h.partition=function(t,e){for(var n=[],i=[],r=0,o=t.length;o>r;++r)e.call(null,t[r],r,t)?n.push(t[r]):i.push(t[r]);return[n,i]},h.memoize=function(t,e){var n=function(i){var r=n.cache,o=e?e.apply(this,arguments):i;return h.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},h.debounce=function(t,e,n){var i;return function(){var r=this,o=arguments,s=function(){i=null,n||t.apply(r,o)},a=n&&!i;i&&(clearTimeout(i),i=null),i=setTimeout(s,e),a&&t.apply(r,o)}},h.now=Date.now||function(){return(new Date).getTime()},h.indexBy=l(function(t,e,n){t[n]=e}),h.groupBy=l(function(t,e,n){(t[n]=t[n]||[]).push(e)}),h.countBy=l(function(t,e,n){t[n]=(t[n]||0)+1}),h}();n.forEach(["noop","identity","forEach","isUndefined","isFunction","isObject","isArray","isNumber","isDate","isElement","isString","extend"],function(t){r[t]=n[t]}),r.clone=n.copy;var o,s,a,u=n.element,l={toJson:n.toJson,fromJson:n.fromJson},h=n.module("waffle",[]);h.run(["$injector","$log","$filter",function(t,e,n){o=t.get("$parse"),a=t.get("$sniffer");try{s=t.get("$sanitize")}catch(i){e.warn("Module ngSanitize is not available, you should add this module to avoid xss injection"),s=r.identity}var u=U.$get;U.$get=function(t){return u(t)||n(t)}}]);var c=function(){var t="key_",e=function(e){return t+e},n=function(){return this instanceof n?void(this.$o={}):new n};return n.prototype={clear:function(){this.$o={}},put:function(t,n){return this.$o[e(t)]=n,this},get:function(t){return this.$o[e(t)]},remove:function(t){return delete this.$o[e(t)],this},contains:function(t){return r.has(this.$o,e(t))}},n}(),d="waffle-",f="waffle-grid",v=d+"sortable",p=v+"-asc",g=v+"-desc",$=d+"draggable",b=$+"-drag",m=$+"-over",y=d+"fixedheader",x=d+"selectable",C=d+"selected",w=d+"checkbox",E="data-waffle-",k=E+"id",N=E+"sortable",S=E+"order",A=E+"idx",D="+",z="-",T="tbody",F="thead",B="tfoot",O="table",R={msie:function(){return e.documentMode},endWith:function(t,e){return!!t&&t.slice(t.length-e.length)===e},isPx:function(t){return R.endWith(t,"px")},isPercentage:function(t){return R.endWith(t,"%")},fromPercentage:function(t){return r.isString(t)?Number(t.replace("%","")):t},toPx:function(t){return r.isNumber(t)?t+"px":t},fromPx:function(t){return r.isString(t)?Number(t.replace("px","")):t},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},resultWith:function(t,e,n){return r.isFunction(t)?t.apply(e,n):t},split:function(t,e){for(var n=e||20,i=[],r=[],o=0,s=t.length;s>o;++o)r.push(t[o]),r.length===n&&(i.push(r),r=[]);return r.length>0&&i.push(r),i},parse:function(t){try{return l.fromJson(t)}catch(e){if("false"===t)return!1;if("true"===t)return!0;var n=Number(t);return r.isNaN(n)?t:n}},destroy:function(t){for(var e in t)r.has(t,e)&&(t[e]=null)},toSpinalCase:function(t){for(var e="",n=0,i=t.length;i>n;++n){var r=t.charAt(n);e+=r.toLowerCase()===r?r:"-"+r.toLowerCase()}return e},asyncTask:function(t,e,n,i){var r=0,o=function(){if(t.length>0){var s=t.shift();n(s,r),r+=s.length,t.length>0?setTimeout(o,e):(i(),o=null)}};setTimeout(o)}},j=function(){var t=function(){var t=e.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",e.body.appendChild(t);var n=t.offsetWidth-t.clientWidth;return e.body.removeChild(t),n},n=function(){return"body"},i={create:function(t){return e.createElement(t)},byId:function(t){var n=e.getElementById(t);return n?[n]:[]},byTagName:function(t,n){return(n||e).getElementsByTagName(t)},createFragment:function(){return e.createDocumentFragment()},findParent:function(t,e){for(;t&&t.tagName!==e;)t=t.parentNode;return t},scrollbarWidth:r.memoize(t,n)};return r.forEach(["tr","td","th",T,F,B,"input","select","option","span"],function(t){i[t]=function(){return this.create(t)}}),r.forEach(["text","checkbox","number","email","url","date","time","datetime"],function(t){var e="input"+R.capitalize(t);i[e]=function(){var e=this.input();return e.setAttribute("type",t),e}}),i}(),P=function(){var t=function(t,e,n){return t.replaceChild(n,e)},e=function(t,e){t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue)},n=function(t,e){for(;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)},i=function(t,e){o.mergeAttributes(t,e);var i=t.childNodes,r=e.childNodes;if(i.length!==r.length)n(t,e);else for(var s=0,a=i.length;a>s;++s)o.mergeNodes(t,i[s],r[s])},o={mergeNodes:function(n,r,o){var s=r.nodeType,a=o.nodeType,u=r.tagName,l=o.tagName,h=r;return s!==a||u!==l?(t(n,r,o),h=o):3===s?e(r,o):i(r,o),h},mergeAttributes:function(t,e){var n=r.indexBy(t.attributes,"name"),i=r.indexBy(e.attributes,"name");r.forEach(r.keys(i),function(e){var r=n[e]||null,o=r?r.value:null,s=i[e].value;o!==s&&t.setAttribute(e,s),r&&delete n[e]}),r.forEach(r.keys(n),function(e){t.removeAttribute(e)})}};return o}(),W=function(){var t=r.noop,e=function(t,e,n){this.type=t,this.bubbles=!1,this.cancelable=!1,this.details=n,this.timeStamp=r.now(),this.target=e,this.currentTarget=e,this.srcElement=e};e.prototype={preventDefault:t,stopPropagation:t,stopImmediatePropagation:t};var n=function(t){return t.toLowerCase()},i=function(){this.$events={}};return i.prototype={addEventListener:function(t,e){var i=n(t),r=this.$events,o=r[i]=r[i]||[];o.push(e)},removeEventListener:function(t,e){var i=n(t),o=this.$events[i];o&&o.length&&(this.$events[i]=r.reject(o,function(t){return t===e}))},dispatchEvent:function(t,i,o){i=n(i);var s=this.$events[i];if(s&&s.length)for(var a=new e(i,t,r.isFunction(o)?o.call(t):o),u=0,l=s.length;l>u;++u)try{s[u].call(t,a)}catch(h){}},clear:function(){this.$events={}}},i}(),I=function(){var t=function(t){return t&&t.length>0},e=function(){var e=this.$$changes,n=this.$$observers;if(t(e)&&t(n)){var i=e.splice(0,e.length);r.forEach(n,function(t){t.callback.call(t.ctx,i)})}},n={observe:function(t,e){return this.$$observers=this.$$observers||[],this.$$observers.push({ctx:e||null,callback:t}),this},unobserve:function(e,n){if(t(this.$$observers))if(0===arguments.length)this.$$observers=[];else{var i=n||null;this.$$observers=r.reject(this.$$observers,function(t){return t.ctx===i&&e===t.callback})}return this},trigger:function(t){return r.isArray(t)||(t=[t]),this.$$changes=this.$$changes||[],this.$$changes.push.apply(this.$$changes,t),setTimeout(r.bind(e,this)),this},pendingChanges:function(){return this.$$changes||[]},clearChanges:function(){return this.$$changes&&this.$$changes.splice(0,this.$$changes.length),this}};return n}(),L=function(){var t=Array.prototype,e=function(){try{var e={};return e[0]=1,!!t.toString.call(e)}catch(n){return!1}}(),n=function(n){return function(){var i=e?this:r.toArray(this);return t[n].apply(i,arguments)}},s=function(t,e,i){return n(t).apply(e,i)},a=function(t,e){var n=e||{};this.$$map=new c,this.$$model=n.model||Object,this.$$key=n.key||"id",r.isFunction(this.$$key)||(this.$$key=o(this.$$key)),this.length=0,t&&t.length&&this.push.apply(this,t)},u=function(t){return parseInt(Number(t)||0,10)},l="splice",h="update",d=function(t,e,n,i,r){return{type:t,removed:e,index:n,addedCount:i,object:r}},f=function(t,e){delete t[e]},v=function(t,e){t.$$map.remove(e)},p=function(t,e){var n=t.$$key(e),i=t.$$map.get(n),r=i?i.idx:null;null!=r&&(f(t,r),v(t,n))},g=function(t,e){if(!r.isObject(e))throw new Error("Waffle collections are not array, only object are allowed");var n;n=e instanceof t.$$model?e:new t.$$model(e);var i=t.$$key(n);if(null==i)throw new Error("Collection elements must have an id, you probably missed to specify the id key on initialization ?");return n},$=function(t,e,n,i){if(t[n]=e,null!=e){var r=arguments.length,o=3===r?t.$$key(e):i,s=t.$$map.get(o)||{};s.idx=n,t.$$map.put(o,s)}},b=function(t,e){var n=t.indexOf(e);return t[n]=e,d(h,[],n,0,t)},m=function(t,e,n){var i=t.at(n),r=t.at(e);$(t,r,n),$(t,i,e)},y=function(t,e,n){for(var i=Math.abs(n),r=t.length-1;r>=e;--r)m(t,r,r+i);t.length+=i},x=function(t,e,n){for(var i=Math.abs(n),r=t.length,o=r-i,s=e+i,a=[],u=s;r>u;++u)m(t,u,u-i);for(var l=o;r>l;++l){var h=t.at(l);a.unshift(h),p(t,h)}return t.length=o,a},C=function(t,e){for(var n,i=t.$$sortFn,o=t.length,s=e.length,a=o+s,u=[],h=o-1,c=s-1,f=a-1;f>=0;--f)if(0>h||i(t[h],e[c])<0){if($(t,e[c--],f),n=r.first(u),n&&n.index===f+1?(n.index=f,n.addedCount++):(n=d(l,[],f,1,t),u.unshift(n)),0>c)break}else $(t,t[h--],f);return t.length=a,u};return a.prototype={options:function(){return{model:this.$$model,key:this.$$key}},at:function(t){return this[t]},byKey:function(t){var e=this.indexOf(t);return e>=0?this.at(e):i},ctx:function(t){var e=r.isObject(t)?this.$$key(t):t;return this.$$map.contains(e)?this.$$map.get(e):null},indexOf:function(t){var e=this.ctx(t);return e?e.idx:-1},contains:function(t){return this.indexOf(t)>=0},findIndex:function(t,e){for(var n=0,i=this.length;i>n;++n)if(t.call(e,this.at(n),n,this))return n;return-1},add:function(t,e){var n=null==e?this.length:e,i=[n,0].concat(t);return this.splice.apply(this,i),this.length},remove:function(t,e){if(r.isNumber(t))return this.splice.call(this,t,e||this.length);if(r.isArray(t)){var n=this.$$key,i=r.indexBy(t,n);return this.remove(function(t){return!!i[n(t)]})}for(var o=t,s=e,a=0,u=null,h=[],c=[],p=0,g=this.length;g>p;++p){var b=this.at(p),m=this.$$key(b);o.call(s,b,p)?(f(this,p),v(this,m),u===p-1?r.last(h).removed.push(b):h.push(d(l,[b],p,0,this)),c.push(b),u=p):(a!==p&&(f(this,p),v(this,m),$(this,b,a,m)),a++)}return this.length-=c.length,h.length>0&&this.trigger(h),c},triggerUpdate:function(t){return this.trigger([d(h,[],t,0,this)]),this},push:function(){return this.add.call(this,r.toArray(arguments))},unshift:function(){return this.add.call(this,r.toArray(arguments),0)},pop:function(){return this.remove(this.length-1,1)[0]},shift:function(){return this.remove(0,1)[0]},toggle:function(t){var e=this.indexOf(t);return e>=0?this.remove(e,1):this.push(t)},clear:function(){if(this.length>0){for(var t=[],e=0,n=this.length;n>e;++e)t[e]=this.at(e),f(this,e);this.$$map.clear(),this.length=0,this.trigger(d(l,t,0,0,this))}return this},reset:function(t){var e=this.length,n=t.length,i=this.$$sortFn;i&&t.sort(i),this.$$map.clear();for(var r=[],o=t.length,s=0;n>s;++s)e>s&&r.push(this.at(s)),$(this,g(this,t[s]),s);for(;e>s;++s)r.push(this.at(s)),f(this,s);return this.length=n,this.trigger([d(l,r,0,o,this)]),this},isEmpty:function(){return 0===this.length},concat:function(){var e=t.concat.apply(this.toArray(),arguments);return new a(e,this.options())},slice:function(){var t=s("slice",this,arguments);return new a(t,this.options())},splice:function(t,e){var n=this.$$sortFn,i=this.length,o=r.rest(arguments,2),s=function(t){return g(this,t)},a=r.map(o,s,this),h=u(t);h=h>=0?Math.min(i,h):Math.max(i+h,0);var c=Math.min(Math.max(u(e)||0,0),i-h),f=[];if(c>0){for(var v=0;c>v;++v)f.push(this[v+h]);x(this,h,c)}var p,m=r.groupBy(a,this.contains,this),w=m[!0]||[],E=m[!1]||[],k=E.length,N=w.length;if(k>0)if(n)E.sort(n),p=C(this,E);else{y(this,h,k);for(var S=0;k>S;++S)$(this,E[S],h+S);p=[d(l,f,h,k,this)]}else p=[];if(f.length>0){var A=r.find(p,function(t){return t.index===h});A?A.removed=f:p.unshift(d(l,f,h,0,this))}var D=[];if(N>0){n&&w.sort(n);for(var z=0;N>z;++z)D.push(b(this,w[z]))}var T=p.concat(D);return T.length>0&&this.trigger(T),f},reverse:function(){if(this.$$sortFn)return this;for(var t=this.length,e=Math.floor(t/2),n=[],i=[],r=0,o=t-1;e>r;++r,--o)m(this,r,o),n.push(d(h,[],r,0,this)),i.unshift(d(h,[],o,0,this));var s=n.concat(i);return s.length&&this.trigger(s),this},split:function(t){return R.split(this,t)},toJSON:function(){return JSON.stringify(this.toArray())},sort:function(t){return this.$$sortFn=t,this.reset(this.toArray()).clearChanges()},pluck:function(t){var e=o(t);return this.map(function(t){return e(t)})}},a.prototype.lastIndexOf=a.prototype.indexOf,r.extend(a.prototype,I),r.forEach(["size","first","last","initial","rest","partition","forEach","map","every","some","reduce","reduceRight","filter","reject","find","toArray"],function(t){r[t]&&(a.prototype[t]=function(){var e=[this].concat(r.toArray(arguments));return r[t].apply(r,e)})}),r.forEach(["countBy","groupBy","indexBy"],function(t){a.prototype[t]=function(e,n){if(r.isString(e)){var i=o(e);e=function(t){return i(t)}}return r[t].call(r,this,e,n)}}),r.forEach(["toString","toLocaleString","join"],function(t){a.prototype[t]=n(t)}),a}(),U=function(){var t=function(t){return(null==t?"":t).toString()},e={$identity:r.identity,$empty:function(){return""},$lowercase:function(e){return t(e).toLowerCase()},$uppercase:function(e){return t(e).toUpperCase()},$capitalize:function(e){return R.capitalize(t(e))},$get:function(t){return e[t]}};return e}(),M={$string:function(t,e){var n=null==t?"":String(t),i=null==e?"":String(e);return n.localeCompare(i)},$number:function(t,e){var n=null==t?0:Number(t),i=null==e?0:Number(e);return n-i},$boolean:function(t,e){var n="false"===t?0:Boolean(t)?1:0,i="false"===e?0:Boolean(e)?1:0;return n-i},$date:function(t,e){var n=r.isDate(t)?t.getTime():new Date(null==t?0:t).getTime(),i=r.isDate(e)?e.getTime():new Date(null==e?0:e).getTime();return n-i},$auto:function(t,e){if(t===e||null==t&&null==e)return 0;var n=r.find(["Number","Boolean","Date","String"],function(n){var i=r["is"+n];return i(t)||i(e)});return n?M["$"+n.toLowerCase()](t,e):e>t?-1:1},$get:function(t){return M[t]}},H=function(t){return r.isArray(t)||(t=[t]),function(e,n){if(e===n||null==e&&null==n)return 0;for(var i=0,r=t.length;r>i;++i){var o=t[i],s=o.parser(e),a=o.parser(n),u=o.fn.call(M,s,a);if(u)return o.desc?-1*u:u}return 0}},V=function(){var t=function(t){return null==t?"":t.toString()},e=function(e,n,i){var r=t(e),o=t(n);return i(r,o)},n=function(t,e){return t.toLowerCase().indexOf(e.toLowerCase())>=0},i=function(t,i){return e(t,i,n)},s=function(t){var e=function(n){return r.some(r.keys(n),function(o){var s=n[o];return r.isObject(s)?e(s):i(n[o],t)})};return e},a=function(t){var e=r.map(r.keys(t),function(e){return function(n){return i(o(e)(n),t[e])}});return function(t){return r.every(e,function(e){return e(t)})}};return{$create:function(t){if(r.isFunction(t))return t;var e=r.isObject(t)?a:s,n=e(t);return n.$predicate=t,n}}}(),J=function(){var t={enable:!0,type:"text",css:null},e={".":"-","(":"",")":"","[":"-","]":"-","'":"",'"':""},n=r.isUndefined,i="$identity",a="$auto",u=R.resultWith,l=R.fromPx,h=R.toPx,c=function(t,e,n){return r.isString(t)&&(t=e.$get(t)),r.isFunction(t)||(t=e.$get(n)),t},d=function(u){r.isString(u)&&(u={id:u});var l=u.escape,h=u.sortable;this.id=u.id,this.title=u.title||"",this.field=u.field||this.id,this.css=u.css||"",this.escape=n(l)?!0:!!l,this.width=u.width,this.sortable=n(h)?!0:!!h,this.draggable=!!u.draggable,this.asc=null;var d=u.editable===!0?{}:u.editable;if(d&&(d=r.defaults(d,t)),this.editable=d,!this.css)for(var f=0,v=this.id.length;v>f;++f){var p=this.id.charAt(f),g=e[p];this.css+=null!=g?g:p}l&&(this.title=s(this.title));var $=u.renderer||i,b=r.isArray($)?$:[$];this.$renderer=r.map(b,function(t){return c(t,U,i)}),this.$comparator=c(u.comparator,M,a),this.$parser=o(this.field)};return d.prototype={cssClasses:function(t,e,n){var i=n?[n]:[],o=u(this.css,this,i);r.isArray(o)&&(o=o.join(" "));var s=[o];this.sortable&&s.push(v),this.draggable&&s.push($);var a=this.asc;return null!=a&&s.push(a?p:g),s.join(" ")},attributes:function(t,e){var n={};if(n[k]=this.id,e){if(this.sortable){n[N]=!0;var i=this.asc;null!=i&&(n[S]=i?D:z)}this.draggable&&(n.draggable=!0)}return n},styles:function(){var t={},e=h(this.computedWidth);return e&&(t.width=e,t.maxWidth=e,t.minWidth=e),t},updateWidth:function(t){return this.width=l(t),this},isEditable:function(t){return this.editable&&this.editable.enable?t?u(this.editable.enable,this,[t]):!0:!1},render:function(t){var e=this.field,n=this.value(t),i=r.reduce(this.$renderer,function(n,i){return i.call(U,n,t,e)},n);return null==i?"":this.escape?s(i):i},value:function(t,e){var n=this.$parser;return 2===arguments.length?(n.assign(t,e),this):null==t?"":n(t)}},d}(),q=function(){var t=function(t,n,i,r){var o=t.length-1;if(0>o||0>n||i>=n)return i;for(var s=Math.min(n,o),a=n;s>=0&&a>=n;){if(a=e.getDataIndex(t[s]),r(a,n))return s;s--}return i},e={getDataIndex:function(t){return Number(t.getAttribute(A))},getRowIndexForDataIndex:function(e,n){return t(e,n,-1,function(t,e){return t===e})},getPreviousRowIndexForDataIndex:function(e,n){return t(e,n-1,-1,function(t,e){return e>=t})},getCheckbox:function(t){return t.childNodes[0].childNodes[0]}};return e}(),K=function(){var t="THEAD",e="TFOOT",n="TBODY",i="TH",o="TR",s="INPUT",a=function(t){return t.tagName===s&&"checkbox"===t.getAttribute("type")},l=function(t){return!!t.getAttribute("draggable")},h=function(t,e){var n=j.findParent(t,e.tagName);return n===e},c={number:function(t){return Number(t)},checkbox:function(t){return!!t}},d={checkbox:"checked"},f=function(t,e){var n=t.target,o=j.findParent(t.target,i);if(n.tagName!==e)if(this.isSelectable()&&a(n))n.checked?this.select():this.deselect();else if(o&&o.getAttribute(N)){var s,u=o.getAttribute(k),l=o.getAttribute(S)||z,h=l===D?z:D,c=h+u;if(t.shiftKey){var d=l+u;s=r.reject(this.$sortBy,function(t){return t===d})}else s=[];s.push(c),this.sortBy(s)}},v={onClickThead:function(e){return f.call(this,e,t)},onClickTfoot:function(t){return f.call(this,t,e)},onClickTbody:function(t){if(this.isSelectable()&&t.target.tagName!==n){var e=j.findParent(t.target,o),i=e.getAttribute(A),r=this.$data.at(i);if(this.isSelectable(r)){var s=this.$selection;if(this.options.selection.multi)if(t.shiftKey){for(var a=parseFloat(i),u=parseFloat(this.$$selectAnchor),l=Math.min(a,u),h=Math.max(a,u),c=[],d=l;h>=d;++d){var f=this.$data.at(d);!s.contains(f)&&this.isSelectable(f)&&c.push(f)}c.length>0&&s.push.apply(s,c)}else s.toggle(r),this.$$selectAnchor=i;else{var v=s.indexOf(r);v>=0?s.remove(v,1):s.reset([r])}}}},onInputTbody:function(t){var e=t.target,n=e.getAttribute(k),i=n?this.$columns.byKey(n):null;if(i&&i.isEditable()){var o=j.findParent(e,"TR");if(o){var s=i.editable.type,a=c[s]||r.identity,u=d[s]||"value",l=Number(o.getAttribute(A)),h=this.$data,f=h.at(l),v=i.value(f),p=a(e[u]);v!==p&&(i.value(f,p),this.dispatchEvent("datachanged",{index:l,object:f,field:n,oldValue:v,newValue:p}),h.triggerUpdate(l))}}},onDragStart:function(t){var e=t.target,n=t.originalEvent||t,i=n.dataTransfer;l(e)&&(u(e).addClass(b),i.effectAllowed="move",i.clearData(),i.setData("Text",e.getAttribute(k)))},onDragEnd:function(t){var e=t.target,n=this.$table[0];u(j.byTagName("th",n)).removeClass(m),l(e)&&h(e,n)&&u(t.target).removeClass(b)},onDragOver:function(t){var e=t.target;if(l(e)&&h(e,this.$table[0])){var n=t.originalEvent||t,i=n.dataTransfer;return i.dropEffect="move",t.preventDefault(),!1}},onDragEnter:function(t){var e=t.target;return l(e)&&h(e,this.$table[0])?(u(e).addClass(m),t.preventDefault(),!1):void 0},onDragLeave:function(t){var e=t.target;return l(e)&&h(e,this.$table[0])?(u(e).removeClass(m),t.preventDefault(),!1):void 0},onDragDrop:function(t){var e=t.target;if(l(e)&&h(e,this.$table[0])){var n=t.originalEvent||t,i=n.dataTransfer,r=i.getData("Text"),o=e.getAttribute(k);if(r!==o){var s=this.$columns,a=s.indexOf(r),c=s.indexOf(o);s.add(s.remove(a,1),c),u(e).removeClass(m)}return t.preventDefault(),!1}},onSelectStart:function(t){var e=t.target;return l(e)?(t.preventDefault(),e.dragDrop(),!1):void 0}};return v}(),G=function(){var e=function(t,e,n,i){var o=t["$"+e];o&&!t.$$events[i]&&(t.$$events[i]=r.bind(K[i],t),o.on(n,t.$$events[i]))},n=function(t,e,n,i){var r=t["$"+e];r&&t.$$events[i]&&(r.off(n,t.$$events[i]),t.$$events[i]=null)},i=function(){var t=a.hasEvent("input")?"input":"keyup";return t+=" change"},o="click",s={bindResize:function(e){if(!e.$$events.onResize){var n=r.bind(e.resize,e);e.$$events.onResize=r.debounce(n,100),e.$window=u(t),e.$window.on("resize",e.$$events.onResize)}},bindEdition:function(t){e(t,T,i(),"onInputTbody")},unbindEdition:function(t){n(t,T,i(),"onInputTbody")},bindSelection:function(t){e(t,F,o,"onClickThead"),e(t,B,o,"onClickTfoot"),e(t,T,o,"onClickTbody")},bindSort:function(t){e(t,F,o,"onClickThead"),e(t,B,o,"onClickTfoot")},bindDragDrop:function(t){e(t,O,"dragstart","onDragStart"),e(t,O,"dragover","onDragOver"),e(t,O,"dragend","onDragEnd"),e(t,O,"dragleave","onDragLeave"),e(t,O,"dragenter","onDragEnter"),e(t,O,"drop","onDragDrop"),R.msie()<=9&&e(t,O,"selectstart","onSelectStart")}};return s}(),_=function(){var t="px",e="percent",n="auto",i={};i[t]=function(t){return R.fromPx(t.computedWidth)},i[e]=function(t,e){return R.fromPercentage(t.computedWidth)*e/100},i[n]=function(t,e,n){return e/n};var o={checkbox:function(t){return!!t}},s={computeWidth:function(o,s){var a=o,u=0,l=s.groupBy(function(i){var o=i.computedWidth=r.result(i,"width");return r.isNumber(o)||R.isPx(o)?t:R.isPercentage(o)?e:n});r.forEach([t,e,n],function(t){var e=l[t];if(e){var n=a,o=e.length;r.forEach(e,function(e){var r=i[t](e,n,o);e.computedWidth=r,a-=r,u++})}})},theadRow:function(t){var e=j.tr();return t.hasCheckbox()&&e.appendChild(s.theadCheckboxCell(t)),t.$columns.forEach(function(n,i){e.appendChild(s.theadCell(t,n,i))}),e},theadCell:function(t,e,n){return u(j.th()).addClass(e.cssClasses(n,!0)).css(e.styles(n,!0)).attr(e.attributes(n,!0)).html(e.title)[0]},theadCheckboxCell:function(t){var e=t.$selection.size(),n=u(j.span()).attr("title",e).html(e),i=t.isSelected(),r=u(j.inputCheckbox()).prop("checked",i).prop("indeterminate",!i&&e>0);return u(j.th()).addClass(w).append(n[0]).append(r[0])[0]},tfootRow:function(t){var e=j.tr();return t.hasCheckbox()&&e.appendChild(s.tfootCheckboxCell(t)),t.$columns.forEach(function(n,i){e.appendChild(s.tfootCell(t,n,i))}),e},tfootCell:function(t,e,n){return s.theadCell(t,e,n)},tfootCheckboxCell:function(t){var e=s.theadCheckboxCell(t);return e.appendChild(e.childNodes[0]),e},tbodyRows:function(t,e,n){for(var i=j.createFragment(),r=0,o=e.length;o>r;++r)i.appendChild(s.tbodyRow(t,e[r],n+r));return i},tbodyRow:function(t,e,n){var i=u(j.tr());return i.attr(A,n),i.attr(k,t.$data.$$key(e)),t.isSelectable()&&(t.isSelectable(e)&&i.addClass(x),t.$selection.contains(e)&&i.addClass(C),t.hasCheckbox()&&i[0].appendChild(s.tbodyCheckboxCell(t,e))),t.$columns.forEach(function(n,r){i[0].appendChild(s.tbodyCell(t,e,n,r))}),i[0]},tbodyCell:function(t,e,n,i){var r=u(j.td()).addClass(n.cssClasses(i,!1,e)).css(n.styles(i,!1)).attr(n.attributes(i,!1)),o=n.isEditable(e);return o?r.append(s.tbodyControl(n,e)):r.html(n.render(e)),r[0]},tbodyCheckboxCell:function(t,e){var n=u(j.td()).addClass(w);if(t.isSelectable(e)){var i=u(j.inputCheckbox()).prop("checked",t.isSelected(e));n.append(i[0])}return n[0]},tbodyControl:function(t,e){var n,i=t.editable;"select"===i.type?(n=j.select(),i.options&&r.forEach(i.options,function(t){var e=j.option();e.innerHTML=null!=t.label?t.label:"",null!=t.value&&(e.value=t.value),n.appendChild(e)})):(n=j.input(),n.setAttribute("type",i.type)),n.setAttribute(k,t.id);var s="checkbox"===i.type?"checked":"value",a=o[i.type]||r.identity;return n[s]=a(t.value(e)),i.css&&(n.className=i.css),n}};return s}(),Y=function(){var t="px",e="percent",n="auto",i={};i[t]=function(t){return R.fromPx(t)},i[e]=function(t,e){return R.fromPercentage(t)*e/100},i[n]=function(t,e,n){return e/n};var o={resize:function(t){o.applySize(t)},applySize:function(t){var e=t.options.size,i=r.result(e,"width"),s=r.result(e,"height"),a=i&&i!==n,u=s&&s!==n;if(a){var l=R.toPx(i);t.$table.css({width:l,maxWidth:l,minWidth:l})}if(u){var h=R.toPx(s);t.$tbody.css({maxHeight:h})}var c=a?R.fromPx(i):null;c||(c=t.$table[0].offsetWidth),c-=j.scrollbarWidth(),t.hasCheckbox()&&(c-=30);var d=t.$columns,f=o.computeWidth(c,d);if(f.length>0)for(var v=r.indexBy(d.pendingChanges(),function(t){return t.type+"_"+t.index}),p=0,g=f.length;g>p;++p){var $=d.indexOf(f[p]);r.has(v,"update_"+$)||d.triggerUpdate($)}return this},computeWidth:function(o,s){var a=o,u=0,l=new c,h=s.groupBy(function(i){var o=r.result(i,"width");return l.put(i.id,o),r.isNumber(o)||R.isPx(o)?t:R.isPercentage(o)?e:n}),d=[];return r.forEach([t,e,n],function(t){var e=h[t];if(e){var n=a,o=e.length;r.forEach(e,function(e){var r=i[t](l.get(e.id),n,o);r!==e.computedWidth&&(e.computedWidth=r,d.push(e)),a-=r,u++})}}),d}};return o}(),Q=function(){var t=q.getDataIndex,e=q.getPreviousRowIndexForDataIndex,n=q.getRowIndexForDataIndex,i={on:function(t){return r.forEach(t,function(t){var e="on"+R.capitalize(t.type);i[e].call(this,t)},this),this},onSplice:function(n){var i,o,s,a=this.$tbody,l=a[0],h=l.childNodes,c=n.index,d=n.addedCount,f=n.object,v=n.removed,p=e(h,c)+1,g=v.length;if(g>0){var $=0===c&&f.length-d===0;if($)i=r.toArray(h),a.empty();else{i=[];for(var b=h[p],m=0;g>m&&b;++m){var y=c+m,x=t(b);x===y&&(i.push(l.removeChild(b)),b=h[p])}}var C=this.$selection;C&&C.length>0&&C.remove(v)}if(d>0){o=[],s=[];for(var w=j.createFragment(),E=this.$filter||r.constant(!0),k=0;d>k;++k){var N=k+c,S=f.at(N),D=f.ctx(S);if(s.push(S),D.visible=E(S),D.visible){var z=_.tbodyRow(this,S,N);o.push(z),w.appendChild(z)}}o.length>0&&(p>0?u(h[p-1]).after(w):a.prepend(w))}if(i||o){for(var T=d-g,F=c+r.size(o),B=h.length;B>F;++F){var O=h[F],R=t(O);O.setAttribute(A,R+T)}this.dispatchEvent("dataspliced",{added:s||[],addedNodes:o||[],removedNodes:i||[],removed:v,index:c,nodeIndex:p})}return this},onUpdate:function(t){var e=t.index,i=this.$data.at(e),r=this.$tbody[0],o=r.childNodes,s=n(o,e);if(s>=0){var a=o[s],u=_.tbodyRow(this,i,e),l=P.mergeNodes(r,a,u);this.dispatchEvent("dataupdated",{index:e,nodeIndex:s,oldNode:a,newNode:l})}return this}};return i}(),X=function(){var t=function(t){return t.getAttribute(k)},e=function(e,n){for(var i=[],o=e.childNodes,s=0,a=o.length;a>s;++s)for(var u=o[s],l=r.indexBy(u.childNodes,t),h=0,c=n.length;c>h;++h){var d=l[n[h].id];d&&i.push(u.removeChild(d))}return i},n=function(t,e,n){return t.insertBefore(e,t.childNodes[n]||null)},i={tbody:function(t,e,n){return _.tbodyCell(this,this.$data.at(n),t,e)},thead:function(t,e){return _.theadCell(this,t,e)},tfoot:function(t,e){return _.tfootCell(this,t,e)}},o=function(t,e,n){return function(r,o){var s=r.childNodes[n],a=i[t].call(this,e,n,o),u=P.mergeNodes(r,s,a);return{oldNode:s,newNode:u}}},s=function(t,e){e.draggable=!!e.draggable||!!t.isDraggable(),t.isSortable()||(e.sortable=!1)},a={on:function(t){return r.forEach(t,function(t){var e="on"+R.capitalize(t.type);a[e].call(this,t)},this),this},onSplice:function(i){var o,a,u,l,h,c=this.$tbody[0],d=this.hasHeader()?this.$thead[0]:null,f=this.hasFooter()?this.$tfoot[0]:null,v=this.hasCheckbox(),p=i.index,g=i.addedCount,$=i.removed,b=[],m=[],y=[],x=this.$data,C=this.$columns,w=$.length,E=w>0||g>0;E&&this.isResizable()&&this.resize(),w>0&&(m.push.apply(m,e(c,$)),d&&b.push.apply(b,e(d,$)),f&&y.push.apply(y,e(f,$)));var N=[],S=[],A=[];if(g>0){for(o=0;g>o;++o){u=p+o;var D=C.at(u);if(s(this,D),d){var z=_.theadCell(this,D,u);l=d.childNodes[0],N.push(n(l,z,v?u+1:u))}if(f){var T=_.tfootCell(this,D,u);l=f.childNodes[0],A.push(n(l,T,v?u+1:u))}}for(a=0,h=c.childNodes.length;h>a;++a){l=c.childNodes[a];var F=r.indexBy(l.childNodes,t),B=l.getAttribute(k),O=x.byKey(B);for(o=0;g>o;++o){u=p+o;var R=C.at(u),j=R.id;F[j]&&l.removeChild(F[j]);var P=_.tbodyCell(this,O,C.at(u),u);S.push(n(l,P,v?u+1:u))}}}if(E){var W=this.isEditable();g>0&&W?G.bindEdition(this):w>0&&!W&&G.unbindEdition(this),this.dispatchEvent("columnsspliced",{index:p,removedNodes:{thead:b,tbody:m,tfoot:y},addedNodes:{thead:N,tbody:S,tfoot:A}})}return this},onUpdate:function(t){var e=t.index,n=this.hasCheckbox()?e+1:e,i=this.$columns.at(e);s(this,i);var a=function(t){var e=[[],[]],s=this["$"+t];if(s){var a=s[0].childNodes,u=o.call(this,t,i,n),l=function(t,e,n){var i=u.call(this,e,n);return t[0].push(i.oldNode),t[1].push(i.newNode),t};e=r.reduce(a,l,e,this)}return e},u=r.map([F,B,T],a,this);return i.editable?G.bindEdition(this):this.isEditable()||G.unbindEdition(this),this.dispatchEvent("columnsupdated",{index:e,oldNodes:{thead:u[0][0],tfoot:u[1][0],tbody:u[2][0]},newNodes:{thead:u[0][1],tfoot:u[1][1],tbody:u[2][1]}}),this}};return a}(),Z=function(){var t=q.getRowIndexForDataIndex,e=q.getCheckbox,n=function(t,e){t.checked=e},i={on:function(t){return r.forEach(t,function(t){var e="on"+R.capitalize(t.type),n=Z[e];n&&n.call(this,t)},this),this},onSplice:function(i){var r,o,s,a,l=this.$tbody,h=this.$data,c=i.object,d=l[0],f=d.childNodes,v=i.index,p=i.removed,g=i.addedCount,$=p.length;if($>0)for(var b=0;$>b;++b)r=h.indexOf(p[b]),r>=0&&(s=t(f,r),o=f[s],o&&(u(o).removeClass(C),this.hasCheckbox()&&(a=e(o),a&&n(a,!1))));if(g>0)for(var m=0;g>m;++m)r=h.indexOf(c.at(v+m)),s=t(f,r),o=f[s],o&&(u(o).addClass(C),this.hasCheckbox()&&(a=e(o),a&&n(a,!0)));if(g>0||$>0){var y=g-$;if(y&&this.hasCheckbox()){var x=c.length,w=this.isSelected(),E=x>0&&h.length!==x,k=this.hasHeader()?this.$thead[0]:null,N=this.hasFooter()?this.$tfoot[0]:null;if(k){var S=k.childNodes[0].childNodes[0],A=S.childNodes[0],D=S.childNodes[1];A.innerHTML=A.title=x,D.checked=w,D.indeterminate=E}if(N){var z=N.childNodes[0].childNodes[0],T=z.childNodes[1],F=z.childNodes[0];T.innerHTML=T.title=x,F.checked=w,F.indeterminate=E}}this.dispatchEvent("selectionchanged",function(){return{selection:this.$selection.toArray()}})}return this}};return i}(),tt=function(){var t={applyFilter:function(t){var e=null==t?r.constant(!0):t,n=function(t,n,i){var o=this.$tbody[0],s=o.childNodes,a=this.$data.ctx(n),u=r.isUndefined(a.visible)?!0:!!a.visible,l=!!e(n),h=0;

if(a.visible=l,u!==l){var c=s[a.idx-t];if(l){var d=_.tbodyRow(this,n,i);o.insertBefore(d,c)}else o.removeChild(c),h++}else l||h++;return t+h},i=this.$data.reduce(n,0,this);this.dispatchEvent("filterupdated",{predicate:t,countVisible:this.$data.size()-i,countFiltered:i})}};return t}(),et=function(){var t=R.resultWith,e=function(t){var e=t||[];return r.isArray(e)||(e=[e]),r.map(e,function(t){var e=t.charAt(0);return e!==D&&e!==z?D+t:t})},n=function(t){var e="$"+t,n=this.$table;this[e]=u(j.byTagName(t,n[0])),this[e].length||(this[e]=u(j[t]())),n.append(this[e][0])},s=function(t){var e=this.options.events[t];e&&this.addEventListener(t.slice(2),this.options.events[t])},a=function(t,e){if(!(this instanceof a))return new a(t,e);var i=this.$table=u(t),o=i[0],l=this.options=e=e||{},h=a.options;r.forEach(r.keys(h),function(t){var e=l[t],n=h[t];if(r.isUndefined(e)){var i=R.toSpinalCase(t),s=o.getAttribute("data-waffle-"+i)||o.getAttribute("data-"+i)||o.getAttribute(i);s&&(e=l[t]=R.parse(s))}r.isObject(n)&&(r.isObject(e)||r.isUndefined(e))&&(e=l[t]=r.defaults(e||{},n)),r.isUndefined(e)&&(e=l[t]=n)}),l.size={width:l.size.width,height:l.size.height},l.scrollable=l.scrollable||!!l.size.height,this.$data=new L(l.data,{key:l.key,model:l.model});var c=this.isSortable(),d=this.isDraggable();!l.columns||c&&!d||r.forEach(l.columns,function(t){c||(t.sortable=!1),d&&(t.draggable=null==t.draggable?!0:!!t.draggable)}),this.$columns=new L(l.columns,{key:"id",model:J});var v=l.scrollable,p=this.isSelectable(),g=this.isEditable();this.$sortBy=[],i.addClass(f),p&&i.addClass(x),v&&i.addClass(y);var $=[T];l.view.thead&&$.unshift(F),l.view.tfoot&&$.push(B),r.forEach($,n,this),this.$data.observe(Q.on,this),this.$columns.observe(X.on,this),this.$$events={},c&&G.bindSort(this),g&&G.bindEdition(this),p&&(this.$selection=new L([],this.$data.options()),this.$selection.observe(Z.on,this),G.bindSelection(this)),this.$bus=new W,r.forEach(r.keys(l.events),s,this),this.isResizable()&&(this.resize(),G.bindResize(this)),this.renderHeader().renderFooter().sortBy(e.sortBy,!1).renderBody(),this.clearChanges(),d&&G.bindDragDrop(this),this.dispatchEvent("initialized")};a.create=function(t,e){return new a(t,e)},a.prototype={data:function(){return this.$data},columns:function(){return this.$columns},selection:function(){return this.$selection},isEditable:function(){return this.options.editable||this.$columns.some(function(t){return t.isEditable()})},isSortable:function(){return this.options.sortable},isSelectable:function(e){var n=this.options.selection;return n&&n.enable?e?t(n.enable,this,[e]):!0:!1},isResizable:function(){var t=this.options.size;return!!t.height||!!t.width},hasCheckbox:function(){return this.isSelectable()&&this.options.selection.checkbox},hasHeader:function(){return!!this.$thead},hasFooter:function(){return!!this.$tfoot},isSelected:function(t){if(!this.isSelectable())return!1;if(t)return this.$selection.contains(t);var e=this.$selection.length;if(0===e)return!1;var n=this.$data.length;return r.isFunction(this.options.selection.enable)&&(n=this.$data.filter(this.isSelectable,this).length),e>=n},isDraggable:function(){return!!this.options.dnd},isVisible:function(t){var e=this.$data.ctx(t);return e&&e.visible!==!1},visibleData:function(){var t=this.$data,e=this.$filter;return null!=e?t.filter(this.isVisible,this):t.toArray()},render:function(t){return this.renderHeader().renderFooter().renderBody(t).clearChanges()},renderHeader:function(){if(this.hasHeader()){var t=_.theadRow(this);this.$thead.empty().append(t)}return this},renderFooter:function(){if(this.hasFooter()){var t=_.tfootRow(this);this.$tfoot.empty().append(t)}return this},renderBody:function(t){var e=null==t?this.options.async:t,n=this,i=r.once(function(){n.$tbody.empty()}),o=function(t,e){var r=_.tbodyRows(n,t,e);i(),n.$tbody.append(r)},s=function(){n.$data.clearChanges(),n.dispatchEvent("rendered",function(){return{data:this.$data,nodes:r.toArray(this.$tbody[0].childNodes)}}),n=i=o=s=null},a=this.$data;return null!=this.$filter&&(a=this.visibleData()),e?R.asyncTask(R.split(a,200),10,o,s):(o(a,0),s()),this},resize:function(){return Y.resize(this),this},select:function(){return this.$selection.length!==this.$data.length&&this.$selection.add(this.$data.filter(this.isSelectable,this)),this},deselect:function(){return this.$selection.isEmpty()||this.$selection.clear(),this},sortBy:function(t,n){var i=e(t);if(this.$sortBy===i||this.$sortBy.join()===i.join())return this;this.$sortBy=i;var s=this.hasHeader(),a=this.hasFooter(),u=s?this.$thead.children().eq(0).children():null,l=a?this.$tfoot.children().eq(0).children():null,h=function(t){t.removeClass(p+" "+g).removeAttr(S)},c=function(t,e,n,i){t.eq(e).addClass(n?p:g).attr(S,i)};u&&h(u),l&&h(l);var d=this.$columns,f=this.hasCheckbox(),v=r.map(this.$sortBy,function(t){var e,n=t.charAt(0),i=t.substr(1),r=n===D,s=d.indexOf(i),a=f?s+1:s;return s>=0?(e=d.at(s),e.asc=r,u&&c(u,a,r,n),l&&c(l,a,r,n)):e={},{parser:e.$parser||o(t),fn:e.$comparator||M.$auto,desc:!r}});return this.$data.sort(H(v)),n!==!1&&this.renderBody(),this.dispatchEvent("sorted")},filter:function(t){var e=null==t||""===t,n=e?i:t,r=this.$filter,o=r?r.$predicate:null,s=null==o||o!==n;return s&&(this.$filter=null==n?i:V.$create(n),tt.applyFilter.call(this,this.$filter)),this},removeFilter:function(){return null!=this.$filter&&this.filter(i),this},dispatchEvent:function(t,e){return this.$bus.dispatchEvent(this,t,e),this.$bus.dispatchEvent(this,"updated"),this},addEventListener:function(t,e){return this.$bus.addEventListener(t,e),this},removeEventListener:function(t,e){return this.$bus.removeEventListener(t,e),this},clearChanges:function(){return this.$data.clearChanges(),this.$columns.clearChanges(),this.$selection&&this.$selection.clearChanges(),this},destroy:function(){this.$table.off(),this.$tbody.off(),this.hasHeader()&&this.$thead.off(),this.hasFooter()&&this.$tfoot.off(),this.$$events.onResize&&this.$window&&(this.$window.off("resize",this.$$events.onResize),this.$window=null),this.clearChanges(),this.$data.unobserve(),this.$columns.unobserve(),this.$selection.unobserve(),this.$bus.clear(),this.$$events=null,R.destroy(this)}},a.options={key:"id",data:null,columns:null,sortBy:null,async:!1,scrollable:!1,sortable:!0,editable:!1,dnd:!1,selection:{enable:!0,checkbox:!0,multi:!1},view:{thead:!0,tfoot:!1},size:{width:null,height:null},events:{}};var l=["onInitialized","onUpdated","onRendered","onDataSpliced","onDataChanged","onDataUpdated","onColumnsSpliced","onColumnsUpdated","onSelectionChanged","onFilterUpdated","onSorted"];return r.forEach(l,function(t){a.options.events[t]=null}),a}(),nt={Grid:et,options:et.options,create:function(t,e){return et.create(t,e)},addRenderer:function(t,e){return U[t]=e,nt},addComparator:function(t,e){return M[t]=e,nt}};h.provider("Waffle",function(){this.$get=function(){return nt},r.forEach(r.keys(nt),function(t){this[t]=nt[t]},this)}),h.run(["$templateCache",function(t){t.put("views/waffle.html","<table></table>")}]),h.directive("waffle",["$parse","$rootScope","$interpolate",function(t,e,n){return{restrict:"AE",replace:!1,require:"?ngModel",templateUrl:"views/waffle.html",link:function(i,o,s,a){var u=[],l=r.noop,h=function(t){var n=t||l;return e.$$phase?n():i.$apply(n)},c=o;"table"!==c[0].tagName.toLowerCase()&&(c=c.children().eq(0));var d=function(t){return t?function(){var e=arguments,n=this,i=h(function(){return t.apply(n,e)});return n=e=null,i}:void 0},f=function(){var e=s.waffleOptions||s.waffleGrid;return t(e)(i)||{}}();r.forEach(r.keys(et.options),function(t){!f[t]&&s[t]&&(f[t]=i.$eval(s[t]))});var v=t(s.waffleGrid).assign||r.noop,p=f.events=f.events||{};r.forEach(r.keys(et.options.events),function(t){var e=p[t]=d(p[t]);s[t]&&(p[t]=d(function(n){e&&e.call(this,n),i.$eval(s[t],{$event:n})}))});var g=nt.create(c,f);v(i,g),g.addEventListener("updated",r.debounce(function(){h()},200)),g.isSelectable()&&(g.addEventListener("selectionchanged",function(t){h(function(){a&&a.$setViewValue(t.details.selection)})}),a&&(a.$formatters.push(function(t){return g.selection().reset(t),t}),a.$isEmpty=function(t){return!t||!t.length}));var $=r.find(["waffleFilter","filter"],function(t){return r.has(s,t)});if($){var b=n(o.attr(s.$attr[$]),!0)||t(s[$]),m=function(t){return g.filter(t)},y=function(){return b(i)};u.push(i.$watchCollection(y,m))}i.$on("$destroy",function(){r.forEach(u,function(t){t()}),g.destroy(),g=f=v=c=u=null})}}}])}(window,document,window.angular,void 0);